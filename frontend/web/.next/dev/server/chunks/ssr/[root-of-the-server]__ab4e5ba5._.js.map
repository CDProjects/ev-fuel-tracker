{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/email/Projects/ev-fuel-tracker/frontend/web/components/StationMap.tsx"],"sourcesContent":["// frontend/web/components/StationMap.tsx\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { MapContainer, TileLayer, Marker, Popup, useMap } from \"react-leaflet\";\r\nimport { LatLngBounds, LatLngExpression } from \"leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\n\r\ninterface Station {\r\n  id: number;\r\n  location: string;\r\n  provider: string;\r\n  price: number;\r\n  lat: number;\r\n  lng: number;\r\n}\r\n\r\ninterface StationMapProps {\r\n  stations: Station[];\r\n  center: LatLngExpression;\r\n  zoom?: number;\r\n}\r\n\r\n/* -------------------------------\r\n   Component to auto-fit map bounds\r\n-------------------------------- */\r\nfunction FitBounds({ stations }: { stations: Station[] }) {\r\n  const map = useMap();\r\n\r\n  useEffect(() => {\r\n    if (!stations || stations.length === 0) return;\r\n\r\n    const bounds = new LatLngBounds(\r\n      stations.map((st) => [st.lat, st.lng]) as [number, number][]\r\n    );\r\n\r\n    map.fitBounds(bounds, { padding: [50, 50] });\r\n  }, [stations, map]);\r\n\r\n  return null;\r\n}\r\n\r\n/* -------------------------------\r\n      Main Map Component\r\n-------------------------------- */\r\nexport default function StationMap({\r\n  stations,\r\n  center,\r\n  zoom = 13,\r\n}: StationMapProps) {\r\n  const [userPosition, setUserPosition] = useState<LatLngExpression | null>(\r\n    null\r\n  );\r\n\r\n  /* ----- Get user location (if allowed) ----- */\r\n  useEffect(() => {\r\n    if (!navigator.geolocation) return;\r\n\r\n    navigator.geolocation.getCurrentPosition(\r\n      (pos) => {\r\n        setUserPosition([pos.coords.latitude, pos.coords.longitude]);\r\n      },\r\n      () => {\r\n        // Permission denied or unavailable ‚Äì we simply ignore and use default\r\n        setUserPosition(null);\r\n      }\r\n    );\r\n  }, []);\r\n\r\n  return (\r\n    <MapContainer\r\n      center={userPosition ?? center}\r\n      zoom={zoom}\r\n      className=\"w-full h-[350px] md:h-[450px] lg:h-[500px] rounded-lg\"\r\n      scrollWheelZoom={true}\r\n    >\r\n      {/* Map Tiles */}\r\n      <TileLayer\r\n        attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OSM</a>'\r\n        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n      />\r\n\r\n      {/* Auto-fit map to station markers */}\r\n      {stations.length > 0 && <FitBounds stations={stations} />}\r\n\r\n      {/* Station markers */}\r\n      {stations.map((st) => (\r\n        <Marker key={st.id} position={[st.lat, st.lng]}>\r\n          <Popup>\r\n            <strong>{st.location}</strong>\r\n            <br />\r\n            Provider: {st.provider}\r\n            <br />\r\n            Price: {st.price.toFixed(2)} ‚Ç¨/kWh\r\n          </Popup>\r\n        </Marker>\r\n      ))}\r\n\r\n      {/* User location marker */}\r\n      {userPosition && (\r\n        <Marker position={userPosition}>\r\n          <Popup>You are here üìç</Popup>\r\n        </Marker>\r\n      )}\r\n    </MapContainer>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,yCAAyC;;;;;;AACzC;AACA;AACA;;;;;;;;;;AAkBA;;iCAEiC,GACjC,SAAS,UAAU,EAAE,QAAQ,EAA2B;IACtD,MAAM,MAAM,IAAA,0IAAM;IAElB,IAAA,gHAAS,EAAC;QACR,IAAI,CAAC,YAAY,SAAS,MAAM,KAAK,GAAG;QAExC,MAAM,SAAS,IAAI,uHAAY,CAC7B,SAAS,GAAG,CAAC,CAAC,KAAO;gBAAC,GAAG,GAAG;gBAAE,GAAG,GAAG;aAAC;QAGvC,IAAI,SAAS,CAAC,QAAQ;YAAE,SAAS;gBAAC;gBAAI;aAAG;QAAC;IAC5C,GAAG;QAAC;QAAU;KAAI;IAElB,OAAO;AACT;AAKe,SAAS,WAAW,EACjC,QAAQ,EACR,MAAM,EACN,OAAO,EAAE,EACO;IAChB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,+GAAQ,EAC9C;IAGF,8CAA8C,GAC9C,IAAA,gHAAS,EAAC;QACR,IAAI,CAAC,UAAU,WAAW,EAAE;QAE5B,UAAU,WAAW,CAAC,kBAAkB,CACtC,CAAC;YACC,gBAAgB;gBAAC,IAAI,MAAM,CAAC,QAAQ;gBAAE,IAAI,MAAM,CAAC,SAAS;aAAC;QAC7D,GACA;YACE,sEAAsE;YACtE,gBAAgB;QAClB;IAEJ,GAAG,EAAE;IAEL,qBACE,qKAAC,gJAAY;QACX,QAAQ,gBAAgB;QACxB,MAAM;QACN,WAAU;QACV,iBAAiB;;0BAGjB,qKAAC,6IAAS;gBACR,aAAY;gBACZ,KAAI;;;;;;YAIL,SAAS,MAAM,GAAG,mBAAK,qKAAC;gBAAU,UAAU;;;;;;YAG5C,SAAS,GAAG,CAAC,CAAC,mBACb,qKAAC,0IAAM;oBAAa,UAAU;wBAAC,GAAG,GAAG;wBAAE,GAAG,GAAG;qBAAC;8BAC5C,cAAA,qKAAC,yIAAK;;0CACJ,qKAAC;0CAAQ,GAAG,QAAQ;;;;;;0CACpB,qKAAC;;;;;4BAAK;4BACK,GAAG,QAAQ;0CACtB,qKAAC;;;;;4BAAK;4BACE,GAAG,KAAK,CAAC,OAAO,CAAC;4BAAG;;;;;;;mBANnB,GAAG,EAAE;;;;;YAYnB,8BACC,qKAAC,0IAAM;gBAAC,UAAU;0BAChB,cAAA,qKAAC,yIAAK;8BAAC;;;;;;;;;;;;;;;;;AAKjB"}}]
}